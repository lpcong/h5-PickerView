"use strict";(function(d){var a=function(g,k){var e=[];var l=31;var j=[4,6,9,11];var h=function(i){return(i%4===0&&i%100!==0||i%400===0)};g=parseInt(g);k=parseInt(k);if(k===2){h(g)?(l=29):(l=28)}else{if(j.indexOf(k)>-1){l=30}}for(var f=0;f<l;f++){e.push(f+1+"日")}return e};var c=function(e){this.pickerOpts=e;this.prefix="_picker-"+new Date().getTime();this.itemHeight=30;this.pos={startY:0,moveY:0,endY:0,curY:0,itemStartY:0};this.checkDate();this.createPickerDom();this.container=document.querySelector("."+this.prefix);this.mask=this.container.querySelector("._picker-mask");this.cols=this.container.querySelectorAll("._picker-col");this.col_list=this.container.querySelectorAll("._picker-data-list");this.btnCancel=this.container.querySelector("._picker-btn-cancel");this.btnConfirm=this.container.querySelector("._picker-btn-confirm");if(this.pickerOpts.selector){this.selector=document.getElementById(this.pickerOpts.selector)}this.bind()};c.prototype={show:function(){this.container.className="_picker-container "+this.prefix},bind:function(){var g=this;var f=function(){if(typeof g.pickerOpts.onCancel==="function"){g.pickerOpts.onCancel()}g.container.className="_picker-container hide"};this.mask.addEventListener("touchend",f,false);this.btnCancel.addEventListener("touchend",f,false);this.btnConfirm.addEventListener("touchend",function(){if(typeof g.pickerOpts.onConfirm==="function"){var h=[];for(var j=0;j<g.pickerOpts.cols.length;j++){var k=g.pickerOpts.cols[j].curVal!==undefined?g.pickerOpts.cols[j].curVal:g.pickerOpts.cols[j].values[0];h.push(g.pickerOpts.type==="date"?parseInt(k.substr(0,k.length-1)):k)}g.pickerOpts.onConfirm(h)}g.container.className="_picker-container hide"},false);this.selector&&this.selector.addEventListener("touchend",function(){g.show()},false);for(var e=0;e<this.cols.length;e++){this.cols[e].addEventListener("touchstart",g.touchEventCallBack(e,"touchstart",g.pos),false);this.cols[e].addEventListener("touchmove",g.touchEventCallBack(e,"touchmove",g.pos),false);this.cols[e].addEventListener("touchend",g.touchEventCallBack(e,"touchend",g.pos),false)}},touchEventCallBack:function(e,f,h){var g=this;return function(m){m.preventDefault();switch(f){case"touchstart":h.startY=m.touches[0].clientY;h.curY=h.itemStartY=(3-g.pickerOpts.cols[e].curIndex)*g.itemHeight;g.col_list[e].classList.remove("animate");break;case"touchmove":h.moveY=m.changedTouches[0].clientY;h.curY=h.itemStartY+(h.moveY-h.startY);g.col_list[e].setAttribute("style","-webkit-transform:translate3d(0, "+h.curY+"px, 0);transform:translate3d(0, "+h.curY+"px, 0)");break;case"touchend":h.endY=m.changedTouches[0].clientY;var j=Math.round((h.startY-h.endY)/g.itemHeight)+g.pickerOpts.cols[e].curIndex;var i=g.pickerOpts.cols[e].values.length;if(j<0){j=0}else{if(j>=i){j=i-1}}g.pickerOpts.cols[e].curIndex=j;g.pickerOpts.cols[e].curVal=g.pickerOpts.cols[e].values[j];g.col_list[e].classList.add("animate");g.col_list[e].setAttribute("style","-webkit-transform:translate3d(0, "+(3-j)*g.itemHeight+"px, 0);transform:translate3d(0, "+(3-j)*g.itemHeight+"px, 0);");if(g.pickerOpts.type==="date"&&(e===1||e===0&&g.pickerOpts.cols[1].curVal==="2月")){var k=g.pickerOpts.cols[0].curVal;var l=g.pickerOpts.cols[1].curVal;g.updateCol(2,{values:a(k.substr(0,k.length-1),l.substr(0,l.length-1))})}if(typeof g.pickerOpts.onSelected==="function"){var n=g.pickerOpts.cols[e].curVal;g.pickerOpts.onSelected(e,g.pickerOpts.cols[e].curIndex,g.pickerOpts.type==="date"?parseInt(n.substr(0,n.length-1)):n)}break}}},checkDate:function(){var e=this.pickerOpts;if(!e.type||e.type!=="date"){return}var f=e.start||1990;var k=e.end||new Date.getFullYear();var n=[],h=[];var o=e.curYear||f,g=e.curMonth||1;for(var m=f;m<=k;m++){n.push(m+"年")}for(var l=0;l<12;l++){h.push(l+1+"月")}this.pickerOpts.cols=[{values:n,curVal:o+"年"},{values:h,curVal:g+"月"},{values:a(o,g),curVal:"1日"}]},createPickerDom:function(){var g=this.pickerOpts;var e="";for(var f=0;f<g.cols.length;f++){this.initCol(g.cols[f]);e+='<div class="_picker-col">'+this.setOptions(g.cols[f])+"</div>"}var h='<div class="_picker-container hide '+this.prefix+'">'+'<div class="_picker-mask"></div>'+'<div class="_picker-wrapper">'+'<div class="_picker-head">'+'<h3 class="_picker-title">'+(g.title||"")+"</h3>"+'<a class="_picker-btn-cancel" href="javascript:;">取消</a>'+'<a class="_picker-btn-confirm" href="javascript:;">确定</a>'+"</div>"+'<div class="_picker-content">'+e+"</div>"+"</div>"+"</div>";var j=document.createElement("div");j.innerHTML=h;document.body.appendChild(j)},setOptions:function(e){this.initCol(e);var g='<ul class="_picker-data-list" style="-webkit-transform:translate3d(0, '+(3-e.curIndex)*this.itemHeight+"px, 0);transform:translate3d(0, "+(3-e.curIndex)*this.itemHeight+'px, 0)">';for(var f=0;f<e.values.length;f++){g+="<li>"+e.values[f]+"</li>"}return g+"</ul>"},initCol:function(f){if(!f.values.length){return}if(f.curVal){var e=f.values.indexOf(f.curVal);if(e===-1){f.curVal=f.values[0];f.curIndex=0}else{f.curIndex=e}}else{f.curVal=f.values[0];
f.curIndex=0}},updateCol:function(f,e){this.cols[f].innerHTML=this.setOptions(e);this.pickerOpts.cols[f]=e;this.col_list=document.querySelectorAll("."+this.prefix+" ._picker-data-list")}};var b=document.createElement("style");b.innerText="._picker-container{position:fixed;z-index:9999;top:0;left:0;bottom:0;right:0;font-size:0;font-family:PingFangSC-Light,'Helvetica Neue',sans-serif;margin:0;padding:0;-webkit-user-select:none;user-select:none;visibility:visible}._picker-container a{outline:0;-webkit-tap-highlight-color:rgba(0,0,0,0)}._picker-mask{position:absolute;top:0;left:0;bottom:0;right:0;background-color:rgba(0,0,0,0.5);-webkit-transition:all .3s ease 0s;transition:all .3s ease 0s;opacity:1}._picker-wrapper{position:absolute;bottom:0;width:100%;-webkit-transition:all .3s ease;transition:all .3s ease}._picker-head{position:relative;height:50px;line-height:50px;background-color:#f4f4f4;overflow:hidden;text-align:center}._picker-title{font-size:16px;font-weight:bold;width:68%;margin:0 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}._picker-btn-cancel,._picker-btn-confirm{font-size:16px;color:#888;text-decoration:none;position:absolute;left:0;top:0;bottom:0;width:16%}._picker-btn-confirm{color:#0c86ff;left:initial;right:0}._picker-content{display:-webkit-box;display:-webkit-flex;display:flex;height:220px;background-color:#fff;font-size:18px;text-align:center;overflow:hidden;position:relative}._picker-content:before{content:'';position:absolute;left:0;right:0;bottom:120px;top:0;pointer-events:none;background:linear-gradient(180deg,hsla(0,0%,100%,.9),hsla(0,0%,100%,.6));border-bottom:solid 1px #ddd;z-index:2}._picker-content:after{content:'';position:absolute;left:0;right:0;bottom:0;top:130px;pointer-events:none;background:linear-gradient(0deg,hsla(0,0%,100%,.9),hsla(0,0%,100%,.6));border-top:solid 1px #ddd;z-index:2}._picker-col{-webkit-box-flex:1;-webkit-flex:1;flex:1;position:relative}._picker-col-inner{position:absolute;width:100%;height:100%;left:0;right:0;top:0;bottom:0}._picker-data-list{padding:0;margin:10px 0}._picker-data-list.animate{-webkit-transition:transform .3s ease 0s;transition:transform .3s ease 0s}._picker-data-list>li{list-style:none;height:30px;line-height:30px}._picker-container.hide{pointer-events:none;visibility:hidden}._picker-container.hide ._picker-mask{opacity:0}._picker-container.hide ._picker-wrapper{bottom:-100%}";document.body.appendChild(b);d.PickerView=c}(window));if(typeof define==="function"&&define.amd){define("pickerView",[],function(){return PickerView})}else{if(typeof module!=="undefined"&&module.exports){module.exports=PickerView}};